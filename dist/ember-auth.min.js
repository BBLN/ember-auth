(function(){var e;e=Em.Object.extend(Em.Evented),window.Auth=e.create({authToken:null,currentUserId:null,currentUser:null,jqxhr:null,prevRoute:null,signIn:function(e){var t,n=this;return e==null&&(e={}),t=e.async!=null?e.async:!0,e.async!=null&&delete e.async,this.ajax(this.resolveUrl(Auth.Config.get("tokenCreateUrl")),"POST",{data:e,async:t}).done(function(e,t,r){var i;return n.set("authToken",e[Auth.Config.get("tokenKey")]),n.set("currentUserId",e[Auth.Config.get("idKey")]),(i=Auth.Config.get("userModel"))&&n.set("currentUser",i.find(n.get("currentUserId"))),n.set("json",e),n.set("jqxhr",r),n.trigger("signInSuccess")}).fail(function(e){return n.set("jqxhr",e),n.trigger("signInError")}).always(function(e){return n.set("prevRoute",null),n.set("jqxhr",e),n.trigger("signInComplete")})},signOut:function(e){var t,n=this;return e==null&&(e={}),e[Auth.Config.get("tokenKey")]=this.get("authToken"),t=e.async!=null?e.async:!0,e.async!=null&&delete e.async,this.ajax(this.resolveUrl(Auth.Config.get("tokenDestroyUrl")),"DELETE",{data:e,async:t}).done(function(e,t,r){return n.set("authToken",null),n.set("currentUserId",null),n.set("currentUser",null),n.set("jqxhr",r),n.trigger("signOutSuccess")}).fail(function(e){return n.set("jqxhr",e),n.trigger("signOutError")}).always(function(e){return n.set("prevRoute",null),n.set("jqxhr",e),n.trigger("signOutComplete")})},resolveUrl:function(e){var t;return t=Auth.Config.get("baseUrl"),t&&t[t.length-1]==="/"&&(t=t.substr(0,t.length-1)),(e!=null?e[0]:void 0)==="/"&&(e=e.substr(1,e.length)),[t,e].join("/")},resolveRedirectRoute:function(e){var t,n,r,i;return e!=="signIn"&&e!=="signOut"?null:(i=""+e[0].toUpperCase()+e.slice(1),n=Auth.Config.get("smart"+i+"Redirect"),t=Auth.Config.get(""+e+"RedirectFallbackRoute"),r=Auth.Config.get(""+e+"Route"),n?this.prevRoute==null||this.prevRoute===r?t:this.prevRoute:t)},ajax:function(e,t,n){var r;if(r=this.get("authToken"))Auth.Config.get("requestHeaderAuthorization")?(n.headers||(n.headers={}),n.headers[Auth.Config.get("requestHeaderKey")]=this.get("authToken")):(n.data||(n.data={}),n.data[Auth.Config.get("tokenKey")]=this.get("authToken"));return n.url=e,n.type=t,n.dataType="json",n.contentType="application/json; charset=utf-8",n.data&&t!=="GET"&&(n.data=JSON.stringify(n.data)),jQuery.ajax(n)}})}).call(this),function(){Auth.Config=Em.Object.create({tokenCreateUrl:null,tokenDestroyUrl:null,tokenKey:null,idKey:null,userModel:null,baseUrl:null,requestHeaderAuthorization:!1,requestHeaderKey:null,signInRoute:null,signOutRoute:null,authRedirect:!1,smartSignInRedirect:!1,smartSignOutRedirect:!1,signInRedirectFallbackRoute:"index",signOutRedirectFallbackRoute:"index",rememberMe:!1,rememberTokenKey:null,rememberPeriod:14,rememberAutoRecall:!0,rememberUsingLocalStorage:!1})}.call(this),function(){Auth.Route=Em.Route.extend(Em.Evented,{redirect:function(){if(!Auth.get("authToken")){this.trigger("authAccess");if(Auth.Config.get("authRedirect"))return Auth.set("prevRoute",this.routeName),this.transitionTo(Auth.Config.get("signInRoute"))}}})}.call(this),function(){Auth.SignInController=Em.ObjectController.extend({registerRedirect:function(){return Auth.addObserver("authToken",this,"smartSignInRedirect")},smartSignInRedirect:function(){if(Auth.get("authToken"))return this.transitionToRoute(Auth.resolveRedirectRoute("signIn")),Auth.removeObserver("authToken",this,"smartSignInRedirect")}})}.call(this),function(){Auth.SignOutController=Em.ObjectController.extend({registerRedirect:function(){return Auth.addObserver("authToken",this,"smartSignOutRedirect")},smartSignOutRedirect:function(){if(!Auth.get("authToken"))return this.transitionToRoute(Auth.resolveRedirectRoute("signOut")),Auth.removeObserver("authToken",this,"smartSignOutRedirect")}})}.call(this),function(){Auth.RESTAdapter=DS.RESTAdapter.extend({ajax:function(e,t,n){return n.context=this,Auth.ajax(e,t,n)}})}.call(this),function(){Auth.Module=Em.Object.create()}.call(this),function(){Auth.Module.RememberMe=Em.Object.create({init:function(){var e=this;return Auth.on("signInSuccess",function(){return e.remember()}),Auth.on("signInError",function(){return e.forget()}),Auth.on("signOutSuccess",function(){return e.forget()})},recall:function(e){var t,n;e==null&&(e={});if(!Auth.Config.get("rememberMe"))return;if(!Auth.get("authToken")&&(n=this.retrieveToken()))return t={},e.async!=null&&(t.async=e.async),t[Auth.Config.get("rememberTokenKey")]=n,Auth.signIn(t)},remember:function(){var e;if(!Auth.Config.get("rememberMe"))return;e=Auth.get("json")[Auth.Config.get("rememberTokenKey")];if(e&&e!==this.retrieveToken())return this.storeToken(e)},forget:function(){if(!Auth.Config.get("rememberMe"))return;return this.removeToken()},retrieveToken:function(){return Auth.Config.get("rememberUsingLocalStorage")?localStorage.getItem("ember-auth-remember-me"):$.cookie("ember-auth-remember-me")},storeToken:function(e){return Auth.Config.get("rememberUsingLocalStorage")?localStorage.setItem("ember-auth-remember-me",e):$.cookie("ember-auth-remember-me",e,{expires:Auth.Config.get("rememberPeriod")})},removeToken:function(){return Auth.Config.get("rememberUsingLocalStorage")?localStorage.removeItem("ember-auth-remember-me"):$.removeCookie("ember-auth-remember-me")}}),Auth.Route.reopen({redirect:function(){var e,t,n;if(Auth.Config.get("rememberMe")&&Auth.Config.get("rememberAutoRecall"))if(t=Auth.Module.RememberMe.recall({async:!1}))return n=this,e=this._super,t.always(function(){return e.call(n)});return this._super()}})}.call(this),function(){}.call(this);